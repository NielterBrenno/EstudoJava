package br.com.alura.forum.configuration;





import br.com.alura.forum.security.service.UsersService;

@Configuration
@EnableWebSecurity
public class AdminSecurityConfiguration extends WebSecurityConfigurerAdapter {
	
	@Autowired
	private	UsersService	usersService;
	@Override
	protected void configure(HttpSecurity	http)	throws	Exception	{
		http.antMatcher("/admin/**")
		.authorizeRequests().anyRequest().hasRole("ADMIN")
		.and()
		.httpBasic();
	}
	@Override
	protected void configure(AuthenticationManagerBuilder	auth)
			throws	Exception	{
		auth.userDetailsService(this.usersService)
		.passwordEncoder(new	BCryptPasswordEncoder());
	}
	

}
